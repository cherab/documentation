

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Beam attenuation calcualtion &mdash; CHERAB 1.2.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> CHERAB
          

          
          </a>

          
            
            
              <div class="version">
                1.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../welcome.html">1. Welcome</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../licence.html">2. Licence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../governance.html">3. Project Governance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation_and_structure.html">4. Installation and Project Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../available_modules.html">5. Available Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../atomic/atomic_data.html">6. Atomic Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plasmas/plasmas.html">7. Plasmas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../emission_models.html">8. Emission Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../math/math.html">9. Function Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/tools.html">10. Tools</a></li>
</ul>
<p class="caption"><span class="caption-text">Demonstrations</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../demonstrations/demonstrations.html">Atomic Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../demonstrations/demonstrations.html#creating-plasmas">Creating Plasmas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../demonstrations/demonstrations.html#surface-radiation-loads">Surface Radiation Loads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../demonstrations/demonstrations.html#active-spectroscopy">Active Spectroscopy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../demonstrations/demonstrations.html#passive-spectroscopy">Passive Spectroscopy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../demonstrations/demonstrations.html#geometry-matrices">Geometry Matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../demonstrations/demonstrations.html#code-examples-gallery">Code examples gallery</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">CHERAB</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Beam attenuation calcualtion</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/models/beam/beam_attenuation_calculation.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="beam-attenuation-calcualtion">
<h1>Beam attenuation calcualtion<a class="headerlink" href="#beam-attenuation-calcualtion" title="Permalink to this headline">¶</a></h1>
<p>In this section, the calculation of beam attenuation in CHERAB is
presented. This documentation is meant to be a concise compilation
of the main aspects needed to carry out a beam attenuation calculation
highlighting what could be implemented in CHERAB and what is implemented
at present and how.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This documentation is useful only if it is correct and up-to-date.
The reader and code developer is asked to report any mistake to the
documentation manager. Thanks.</p>
</div>
<table class="docutils align-default" id="id1">
<caption><span class="caption-text">Notations for this section</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Notation</p></th>
<th class="head"><p>Meaning</p></th>
<th class="head"><p>Unit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(n_e\)</span></p></td>
<td><p>Electron density</p></td>
<td><p><span class="math notranslate nohighlight">\(m^{-3}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(n_{H^0}\)</span></p></td>
<td><p>Density of atom <span class="math notranslate nohighlight">\(H^0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(m^{-3}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(n_I\)</span></p></td>
<td><p>Total ion density</p></td>
<td><p><span class="math notranslate nohighlight">\(m^{-3}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(n_I^{i, equiv}\)</span></p></td>
<td><p>Equivalent ion density of ion <em>i</em></p></td>
<td><p><span class="math notranslate nohighlight">\(m^{-3}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(n_i\)</span></p></td>
<td><p>Density of plasma ion <em>i</em></p></td>
<td><p><span class="math notranslate nohighlight">\(m^{-3}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(n_e^i\)</span></p></td>
<td><p>Electron density corresponding to ion <em>i</em></p></td>
<td><p><span class="math notranslate nohighlight">\(m^{-3}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(n_e^{i, equiv}\)</span></p></td>
<td><p>Equivalent electron density of ion <em>i</em>, to be used in the extraction of the stopping coefficient.</p></td>
<td><p><span class="math notranslate nohighlight">\(m^{-3}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\alpha_i\)</span></p></td>
<td><p>Charge of plasma ion <em>i</em></p></td>
<td><p>dimensionless (integer)</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(f_i\)</span></p></td>
<td><p>Ionic fraction of ion <em>i</em></p></td>
<td><p>dimensionless</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(T_i\)</span></p></td>
<td><p>Temperature of ion <em>i</em></p></td>
<td><p><em>eV</em></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(E_c^i\)</span></p></td>
<td><p>Collision energy between plasma ions <em>i</em> and beam neutrals</p></td>
<td><p><em>eV/amu</em></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(Q_{ST}\)</span></p></td>
<td><p>Ionisation rate of atom <span class="math notranslate nohighlight">\(H^0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(m^{-3}.s^{-1}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(Q_{ST}^i\)</span></p></td>
<td><p>Ionisation rate of atom <span class="math notranslate nohighlight">\(H^0\)</span> by ions <em>i</em> and their electrons</p></td>
<td><p><span class="math notranslate nohighlight">\(m^{-3}.s^{-1}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(S_{ST}\)</span></p></td>
<td><p>Composite beam stopping coefficient for atom <span class="math notranslate nohighlight">\(H^0\)</span> defined with respect to electron density.</p></td>
<td><p><span class="math notranslate nohighlight">\(m^3/s\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(S_{ST}^i\)</span></p></td>
<td><p>Beam stopping coefficient for atom <span class="math notranslate nohighlight">\(H^0\)</span> by ions <em>i</em> and their electrons defined with respect to ion density.</p></td>
<td><p><span class="math notranslate nohighlight">\(m^3/s\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(S_{ST}^{i, e}\)</span></p></td>
<td><p>Beam stopping coefficient for atom <span class="math notranslate nohighlight">\(H^0\)</span> by ions <em>i</em> and their electrons defined with respect to electron density.</p></td>
<td><p><span class="math notranslate nohighlight">\(m^3/s\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(Z_{eff}\)</span></p></td>
<td><p>Plasma effective charge</p></td>
<td><p>dimensionless</p></td>
</tr>
</tbody>
</table>
<p>The rate <span class="math notranslate nohighlight">\(Q_{ST}^i\)</span> at which neutrals are ionised in the beam by one
ionic species <em>i</em> can be calculated from the beam stopping coefficient
<span class="math notranslate nohighlight">\(S_{ST}^i\)</span> with the formula:</p>
<div class="math notranslate nohighlight">
\[Q_{ST}^i = n_i.n_{H^0}.S_{ST}^i \quad \text{with} \quad \left.\frac{n_{H^0}}{dt}\right|_{\text{(ionisation by ion i)}} = - Q_{ST}^i\]</div>
<p><span class="math notranslate nohighlight">\(S_{ST}^i\)</span> corresponds closely to the effective ionisation coefficient.
It depends on the collisional energy between ions and neutrals, ion temperature
and ion density: <span class="math notranslate nohighlight">\(S_{ST}^i = S_{ST}^i[E_c^i, n_i, T_i]\)</span>. Here we consider
both main ion and impurities.</p>
<div class="section" id="stopping-coefficients-with-respect-to-electron-density">
<h2>Stopping coefficients with respect to electron density<a class="headerlink" href="#stopping-coefficients-with-respect-to-electron-density" title="Permalink to this headline">¶</a></h2>
<p>Although ion impact ionisation and charge transfer are the most efficient
reactions causing beam stopping, it is usual in fusion to define the stopping
coefficient with respect to the electron density:</p>
<div class="math notranslate nohighlight">
\[Q_{ST}^i = n_e^i.n_{H^0}.S_{ST}^{i, e}\]</div>
<p>Still considering only one ionic species <em>i</em>, quasi-neutrality gives: <span class="math notranslate nohighlight">\(n_i.\alpha_i = n_e^i\)</span></p>
<p>So: <span class="math notranslate nohighlight">\(Q_{ST}^i = n_i.n_{H^0}.\alpha_i.S_{ST}^{i, e}\)</span></p>
<p>Which means: <span class="math notranslate nohighlight">\(S_{ST}^{i, e} = S_{ST}^i/\alpha_i\)</span></p>
<p>In reality, there is more than one ion specie in the plasma, and therefore the
calculation of the stopping coefficient is dependent on the plasma composition.
We will see below how an accurate calculation can be made for the effective
stopping coefficient and which simplification can be made for a more
time-efficient calculation.</p>
</div>
<div class="section" id="the-collisional-radiative-model-for-beam-stopping">
<h2>The collisional-radiative model for beam stopping<a class="headerlink" href="#the-collisional-radiative-model-for-beam-stopping" title="Permalink to this headline">¶</a></h2>
<p>It was found advantageous to embed the calculation of beam stopping (and beam
emission) by hydrogen in a more general picture of neutral hydrogen as a
radiating, ionizing and recombining species in the fusion plasma.</p>
<p>Following collisional-radiative theory, the model calculates the <strong>quasi-static
equilibrium</strong> excited population structure relative to the instantaneous hydrogen
ground-state and ionised-state populations in a very many n-shell bundled-n
approximation.</p>
<p><strong>Quasi-static equilibrium collisional-radiative assumption under these conditions</strong></p>
<blockquote>
<div><p>In a nutshell:</p>
<ul class="simple">
<li><p>The time in which the population of the excited levels comes into
equilibrium with the ground population density and plasma conditions is
so short that the population density of the excited energy levels can be
considered to be in equilibrium with the population density of the ground
levels. However, metastable states represent an exception, these states
have an equilibration time with the ground state comparable to the
characteristic time of ionisation and recombination processes. So a
quasi-steady state approximation is adopted where the equilibrium
population densities of ordinary excited states are functions of the
population density of the ground and metastable levels. The rate at which
the population density of the ground and metastable states evolves is
related to the collisional radiative and ionisation rate coefficients.</p></li>
<li><p>The upper levels approach Saha-Boltzmann population density because the
probability for radiative transition, A, decreases with increasing
quantum number whilst the collisional rate increases. Therefore, for
energy levels higher than a level <span class="math notranslate nohighlight">\(n_s\)</span>, the population densities are
governed by collisional processes, leading to the Saha-Boltzmann
population.</p></li>
</ul>
</div></blockquote>
<p><strong>Assumption: there is no need to take into account the effect of spatial transport of metastable</strong></p>
<blockquote>
<div><p>Probably ok for beam stopping, not always for beam emission.</p>
<ul class="simple">
<li><p>The localisation of beam emission measurements of the confined plasma,
analysed with adoption of the theoretical quasi-static equilibrium
assumption, cannot be better than <span class="math notranslate nohighlight">\(3.10^{-2} m\)</span> in the JET experiment [Anderson2000].</p></li>
<li><p>Neutral beam diagnostic probes of edge/scrape-off-layer plasma with
temperature and density scale lengths of about <span class="math notranslate nohighlight">\(3.10^{-2} m\)</span> must be modelled
in the full , spatially non-equilibrium picture.</p></li>
<li><p>As has been discussed in previous work, hydrogen with its high first
excitation energy is suited as an equilibrium, fast, deep neutral beam
probe while a medium/slow lithium beam is suited as a non-equlibrium edge
probe.</p></li>
<li><p>A helium beam, because of the presence of the triplet metastable, shows
a mixed character in which the detailed interplay of relaxation times,
quasi-static equilibrium assumptions and plasma scale lengths are
demonstrated. Analysis of the helium diagnostic beam thus requires
generalized collisional-radiative theory.</p></li>
</ul>
</div></blockquote>
<p>For hydrogenic systems only populations of complete n shells need to be
evaluated (assume relative statistical population for the l states). Thus for
hydrogenic systems only populations of complete n-shells need to be evaluated,
the bundle-n approximation.</p>
<div class="topic">
<p class="topic-title first">ADAS310</p>
<p>Full implementation of the collisional-radiative model for hydrogen in the
bundled-n approximation. It iterates through sets of plasma conditions,
which include the plasma density, temperature and neutral beam energy.
Output from ADAS310 includes all collisional-radiative ionization and
recombination coefficients <span class="math notranslate nohighlight">\(S_{CR}\)</span> and <span class="math notranslate nohighlight">\(\alpha_{CR}\)</span>, with
and without the influence of charge-transfer, at each set if plasma
conditions. <span class="math notranslate nohighlight">\(S_{CR}\)</span> are in fact the <span class="math notranslate nohighlight">\(S_{ST}^{i, e}\)</span> mentioned
above. This is a structured output organised according to ADAS data format
adf26. ADAS310 accepts as input the definitions of these scans. Established
an extended list of cases required to achieve the latter and then executes
repeated population calculations at each set of plasma conditions in the
list.</p>
</div>
<p>ADAS310 can compute the populations for any mixture of light impurities (H+ to
Ne10+) in the plasma. It is impractical to tabulate all possible mixtures of
impurities. It is our usual practise to execute ADAS310 in turn for each light
impurity species from hydrogen to neon treated as a pure species. The mixed
species effective coefficients are constructed from these pure impurity
solutions as a linear superposition by the theoretical data acquisition
routines in CHEAP.</p>
</div>
<div class="section" id="building-up-the-beam-stopping-coefficient-from-the-pure-impurity-solutions-simplification-adopted-to-make-calculation-faster">
<h2>Building-up the beam stopping coefficient from the pure impurity solutions: simplification adopted to make calculation faster<a class="headerlink" href="#building-up-the-beam-stopping-coefficient-from-the-pure-impurity-solutions-simplification-adopted-to-make-calculation-faster" title="Permalink to this headline">¶</a></h2>
<div class="topic">
<p class="topic-title first">ADAS312</p>
<p>It is the interactive post-processing code designed to extract effective
stopping and emission coefficients from the comprehensive adf26 file and
archive the data in condensed rapid-look-up tables in their respective ADAS
data formats of adf21 and adf22. The effective coefficients are most
sensitive to the beam particle energy and the plasma ion density and less
sensitive to plasma ion temperature. Suitable tabulations can therefore be
built on a reference set of plasma and beam conditions, namely a
two-dimensional array of coefficients as functions of beam energy and
plasma density at the reference conditions of the plasma ion temperature
and then a one-dimensional vector of coefficients as a function of the
plasma ion temperature at the reference conditions of the other parameters.</p>
</div>
<p>If now instead of one ion species, we consider n ion species, the rate at which
atoms <span class="math notranslate nohighlight">\(H^0\)</span> in a beam are ionised <span class="math notranslate nohighlight">\(Q_{ST}\)</span> can be written as:</p>
<div class="math notranslate nohighlight">
\[Q_{ST}=\sum_iQ_{ST}^i=\sum_i n_in_{H^0}S_{ST}^i\quad\text{where}\quad\left.\frac{n_{H^0}}{dt}\right|_{\text{(all ionisations)}}=-Q_{ST}\]</div>
<p>Now replacing <span class="math notranslate nohighlight">\(S_{ST}^i\)</span> with <span class="math notranslate nohighlight">\(S_{ST}^{i, e}\)</span>:</p>
<div class="math notranslate nohighlight">
\[Q_{ST}=\sum_in_in_{H^0}\alpha_iS_{ST}^{i, e}=n_{H^0}\sum_in_i^eS_{ST}^{i, e}\]</div>
<p>Defining the composite stopping coefficient with respect to electron density <span class="math notranslate nohighlight">\(S_{ST}\)</span> by:</p>
<div class="math notranslate nohighlight">
\[Q_{ST}=n_en_{H^0}S_{ST}\]</div>
<p>This leads to:</p>
<div class="math notranslate nohighlight">
\[n_e.S_{ST}=n_{H^0}\sum_in_i^eS_{ST}^{i, e}\]</div>
<p>The coefficient is written in terms of the primary parameters <span class="math notranslate nohighlight">\(E_c^i, n_i, T_i\)</span>.
It remains to define what should be taken as the parameter for electron density
which is equivalent electron density to be used in the extraction of the
stopping coefficient contribution from the <span class="math notranslate nohighlight">\(i^{th}\)</span> pure impurity archive
equivalent to the ion density <span class="math notranslate nohighlight">\(n_i\)</span> in the case of this multi-ion plasma.</p>
<p>In this composite ion plasma, the effective charge is:</p>
<div class="math notranslate nohighlight">
\[Z_{eff}=\frac{\sum_jn_j\alpha_j^2}{\sum_jn_j\alpha_j}=\frac{\sum_jn_j\alpha_j^2}{n_e}\]</div>
<p>The following assumption is made, that the quantity we are keeping constant for
the plasma conditions is <span class="math notranslate nohighlight">\(n_e.Z_{eff}\)</span>. Then, the equivalent ion density is defined by:</p>
<div class="math notranslate nohighlight">
\[n_e.Z_{eff}=n_I^{i, equiv}\alpha_i^2\]</div>
<p>Therefore, the equivalent electron density is:</p>
<div class="math notranslate nohighlight">
\[n_e^{i, equiv}=\alpha_in_I^{i, equiv}=\frac{n_e}{\alpha_i}Z_{eff}\]</div>
<p>Finally:</p>
<div class="math notranslate nohighlight">
\[n_e^{i, equiv}=\frac{\sum_jn_j\alpha_j^2}{\alpha_i}\]</div>
<p>A detailed error analysis of the effect of this approximations has been carried
out by Anderson[1999] by comparison with ADAS310 calculations using the true
mixtures. The errors from the compact tabulations of the beam emission
coefficient are more substantial, but less than 1% for reasonable ranges of
plasma and beam conditons. [Delabie also in annex].</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is appropriate to re-tune the tabulations of reference beam and plasma
conditions for application to other plasma/injection systems. (He beams, …..)</p>
</div>
</div>
<div class="section" id="features-implemented-in-cherab">
<h2>Features implemented in CHERAB<a class="headerlink" href="#features-implemented-in-cherab" title="Permalink to this headline">¶</a></h2>
<p><strong>Assumption: no need to take into account the spatial transport of metastables in the plasma</strong></p>
<blockquote>
<div><p>(more relevant to beam emission)</p>
</div></blockquote>
</div>
<div class="section" id="litterature-on-which-this-note-is-based">
<h2>Litterature on which this note is based<a class="headerlink" href="#litterature-on-which-this-note-is-based" title="Permalink to this headline">¶</a></h2>
<p>Anderson 2000</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, CHERAB Team

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>